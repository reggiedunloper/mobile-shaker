<!doctype html>
<html>
  <head>
    <title>Mobile Shaker Test</title>
  </head>
  <body>
    <main>
      <h1>Test Shaker 1</h1>
      <h2>50</h2>
      <p id="x">0</p>
      <p id="y">0</p>
      <p id="z">0</p>
      <p id="status"></p>
    </main>
    <script>

      let totalvalue = Number(document.querySelector('h2').innerText);
      let state = 0;

      let intervalid = setInterval(checkMovement, 1000, state);

      function checkMovement(currstate) {
        if(state) {
          document.querySelector('#status').innerText = "MOVING";
        } else {
          document.querySelector('#status').innerText = "STOPPED";
        }
      }

      function updateTotal(amount) {
        if (amount > 10) {
          state = 1;
          let currvalue = Number(document.querySelector('h2').innerText)
          currvalue = currvalue + amount
          document.querySelector('h2').innerText = currvalue
        } else {
          state = 0;
        }
      }

      function handleMotionEvent(event) {
        console.log(event);
        var xmovement = Math.abs(event.acceleration.x);
        var ymovement = Math.abs(event.acceleration.y);
        var zmovement = Math.abs(event.acceleration.z);


        document.querySelector('#x').innerText = xmovement
        document.querySelector('#y').innerText = ymovement
        document.querySelector('#z').innerText = zmovement

        updateTotal(xmovement + ymovement + zmovement);

      }

      window.addEventListener("devicemotion", handleMotionEvent, true);
    </script>
  </body>
</html>